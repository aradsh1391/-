import csv
import random
import sys

def generate_large_csv(filename, num_rows=1_000_000, num_columns=5, min_val=1, max_val=1000):
    """
    Generate a large CSV file with random integers.

    :param filename: Output CSV file name
    :param num_rows: Number of rows to generate
    :param num_columns: Number of integer columns per row
    :param min_val: Minimum random integer value
    :param max_val: Maximum random integer value
    """
    try:
        with open(filename, mode='w', newline='', encoding='utf-8') as file:
            writer = csv.writer(file)

            # Optional: Write header
            header = [f"col_{i+1}" for i in range(num_columns)]
            writer.writerow(header)

            for _ in range(num_rows):
                row = [random.randint(min_val, max_val) for _ in range(num_columns)]
                writer.writerow(row)

        print(f"✅ Successfully generated {num_rows} rows in '{filename}'.")

    except (OSError, IOError) as e:
        print(f"❌ File error: {e}", file=sys.stderr)
    except Exception as e:
        print(f"❌ Unexpected error: {e}", file=sys.stderr)


if __name__ == "__main__":
    # Example: 1 million rows, 5 columns, values between 1 and 1000
    generate_large_csv("large_random.csv", num_rows=1_000_000, num_columns=5, min_val=1, max_val=1000)
